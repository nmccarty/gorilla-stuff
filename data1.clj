;; gorilla-repl.fileformat = 1

;; @@
(ns economy-health
  (:require [gorilla-plot.core :as plot]
            [clojure.string :as string]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(def player-file (slurp "/home/nmccarty/players.csv"))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;economy-health/player-file</span>","value":"#'economy-health/player-file"}
;; <=

;; @@
(def monies (->> player-file
                 (string/split-lines)
                 (map #(string/split % #";"))
                 (drop 26)
                 (map last)
                 (map #(Long/parseLong %))
                 (filter #(> % 545))
                 (filter #(< % 5000))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;economy-health/monies</span>","value":"#'economy-health/monies"}
;; <=

;; @@
(count monies)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>185</span>","value":"185"}
;; <=

;; @@
(take 10 monies)
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-lazy-seq'>(</span>","close":"<span class='clj-lazy-seq'>)</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>815</span>","value":"815"},{"type":"html","content":"<span class='clj-long'>1707</span>","value":"1707"},{"type":"html","content":"<span class='clj-long'>790</span>","value":"790"},{"type":"html","content":"<span class='clj-long'>3275</span>","value":"3275"},{"type":"html","content":"<span class='clj-long'>860</span>","value":"860"},{"type":"html","content":"<span class='clj-long'>4885</span>","value":"4885"},{"type":"html","content":"<span class='clj-long'>590</span>","value":"590"},{"type":"html","content":"<span class='clj-long'>1190</span>","value":"1190"},{"type":"html","content":"<span class='clj-long'>1205</span>","value":"1205"},{"type":"html","content":"<span class='clj-long'>1030</span>","value":"1030"}],"value":"(815 1707 790 3275 860 4885 590 1190 1205 1030)"}
;; <=

;; @@
(reduce (fn [[x1 x2] [y1 y2]]
          (if (> x2 y2)
            [x1 x2]
            [y1 y2]))
        (frequencies monies))
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-long'>560</span>","value":"560"},{"type":"html","content":"<span class='clj-long'>12</span>","value":"12"}],"value":"[560 12]"}
;; <=

;; @@
(reduce max monies)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-long'>4885</span>","value":"4885"}
;; <=

;; @@
(reduce min monies)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-long'>550</span>","value":"550"}
;; <=

;; @@
(plot/compose
 (plot/histogram monies 
                :bins 57)
 (plot/plot #(/ (/ (- % 549) 3000)) [550 4885]))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"bottom":20,"top":10,"right":10,"left":50},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"c2a92184-0dfe-4a33-ae87-8b0d70548078","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"c2a92184-0dfe-4a33-ae87-8b0d70548078","field":"data.y"}}],"axes":[{"scale":"x","type":"x"},{"scale":"y","type":"y"}],"data":[{"name":"c2a92184-0dfe-4a33-ae87-8b0d70548078","values":[{"x":550.0,"y":0},{"x":626.0526315789474,"y":41.0},{"x":702.1052631578948,"y":34.0},{"x":778.1578947368422,"y":15.0},{"x":854.2105263157896,"y":14.0},{"x":930.263157894737,"y":11.0},{"x":1006.3157894736844,"y":6.0},{"x":1082.3684210526317,"y":8.0},{"x":1158.421052631579,"y":3.0},{"x":1234.4736842105262,"y":6.0},{"x":1310.5263157894735,"y":6.0},{"x":1386.5789473684208,"y":4.0},{"x":1462.631578947368,"y":4.0},{"x":1538.6842105263154,"y":3.0},{"x":1614.7368421052627,"y":2.0},{"x":1690.78947368421,"y":3.0},{"x":1766.8421052631572,"y":3.0},{"x":1842.8947368421045,"y":0.0},{"x":1918.9473684210518,"y":4.0},{"x":1994.999999999999,"y":1.0},{"x":2071.0526315789466,"y":1.0},{"x":2147.105263157894,"y":0.0},{"x":2223.1578947368416,"y":1.0},{"x":2299.210526315789,"y":0.0},{"x":2375.2631578947367,"y":2.0},{"x":2451.315789473684,"y":1.0},{"x":2527.3684210526317,"y":0.0},{"x":2603.421052631579,"y":2.0},{"x":2679.4736842105267,"y":0.0},{"x":2755.526315789474,"y":3.0},{"x":2831.5789473684217,"y":0.0},{"x":2907.6315789473692,"y":0.0},{"x":2983.6842105263167,"y":0.0},{"x":3059.7368421052643,"y":1.0},{"x":3135.7894736842118,"y":1.0},{"x":3211.8421052631593,"y":0.0},{"x":3287.894736842107,"y":1.0},{"x":3363.9473684210543,"y":0.0},{"x":3440.000000000002,"y":0.0},{"x":3516.0526315789493,"y":0.0},{"x":3592.105263157897,"y":1.0},{"x":3668.1578947368444,"y":0.0},{"x":3744.210526315792,"y":0.0},{"x":3820.2631578947394,"y":0.0},{"x":3896.315789473687,"y":0.0},{"x":3972.3684210526344,"y":0.0},{"x":4048.421052631582,"y":0.0},{"x":4124.473684210529,"y":0.0},{"x":4200.526315789477,"y":0.0},{"x":4276.578947368424,"y":2.0},{"x":4352.631578947372,"y":0.0},{"x":4428.6842105263195,"y":0.0},{"x":4504.736842105267,"y":0.0},{"x":4580.7894736842145,"y":0.0},{"x":4656.842105263162,"y":0.0},{"x":4732.8947368421095,"y":0.0},{"x":4808.947368421057,"y":0.0},{"x":4885.000000000005,"y":1.0},{"x":4961.052631578952,"y":0}]},{"name":"27f7518d-f036-4900-8aa8-534d567323cd","values":[{"x":550,"y":3000},{"x":593.3499984741211,"y":67.643745281086},{"x":636.6999969482422,"y":34.20752684598731},{"x":680.0499954223633,"y":22.892026743925083},{"x":723.3999938964844,"y":17.201835464401785},{"x":766.7499923706055,"y":13.777267991330485},{"x":810.0999908447266,"y":11.489851034824696},{"x":853.4499893188477,"y":9.85383512974319},{"x":896.7999877929688,"y":8.625647226260913},{"x":940.1499862670898,"y":7.66969220331636},{"x":983.4999847412109,"y":6.904488159618247},{"x":1026.849983215332,"y":6.278120969710528},{"x":1070.1999816894531,"y":5.755948014955019},{"x":1113.5499801635742,"y":5.3139670629884215},{"x":1156.8999786376953,"y":4.935022381022293},{"x":1200.2499771118164,"y":4.606526073604629},{"x":1243.5999755859375,"y":4.319032688518765},{"x":1286.9499740600586,"y":4.065316221226458},{"x":1330.2999725341797,"y":3.8397543907103593},{"x":1373.6499710083008,"y":3.637907118740204},{"x":1416.9999694824219,"y":3.45622131967224},{"x":1460.349967956543,"y":3.291819943469897},{"x":1503.699966430664,"y":3.1423484921824154},{"x":1547.0499649047852,"y":3.0058615354855536},{"x":1590.3999633789062,"y":2.880737570093874},{"x":1633.7499618530273,"y":2.7656142940768036},{"x":1677.0999603271484,"y":2.659338804630399},{"x":1720.4499588012695,"y":2.5609288535635475},{"x":1763.7999572753906,"y":2.4695423983455997},{"x":1807.1499557495117,"y":2.3844534479300794},{"x":1850.4999542236328,"y":2.3050327357019014},{"x":1893.849952697754,"y":2.23073213036297},{"x":1937.199951171875,"y":2.1610719676711514},{"x":1980.549949645996,"y":2.0956306838904655},{"x":2023.8999481201172,"y":2.0340362773920697},{"x":2067.2499465942383,"y":1.9759592330167022},{"x":2110.5999450683594,"y":1.921106624954879},{"x":2153.9499435424805,"y":1.869217175320954},{"x":2197.2999420166016,"y":1.8200570924789756},{"x":2240.6499404907227,"y":1.7734165492476204},{"x":2283.9999389648438,"y":1.7291066890699116},{"x":2327.349937438965,"y":1.6869570700580765},{"x":2370.699935913086,"y":1.6468134739744158},{"x":2414.049934387207,"y":1.6085360207718513},{"x":2457.399932861328,"y":1.5719975401078532},{"x":2500.749931335449,"y":1.5370821598785993},{"x":2544.0999298095703,"y":1.5036840787650902},{"x":2587.4499282836914,"y":1.4717064953986396},{"x":2630.7999267578125,"y":1.441060671316378},{"x":2674.1499252319336,"y":1.4116651086029082},{"x":2717.4999237060547,"y":1.3834448261694552},{"x":2760.849922180176,"y":1.3563307211381506},{"x":2804.199920654297,"y":1.330259003880071},{"x":2847.549919128418,"y":1.305170696983411},{"x":2890.899917602539,"y":1.2810111898680856},{"x":2934.24991607666,"y":1.257729841967462},{"x":2977.5999145507812,"y":1.2352796284088279},{"x":3020.9499130249023,"y":1.2136168229755624},{"x":3064.2999114990234,"y":1.192700713853289},{"x":3107.6499099731445,"y":1.1724933482718969},{"x":3150.9999084472656,"y":1.1529593026735498},{"x":3194.3499069213867,"y":1.1340654754785726},{"x":3237.699905395508,"y":1.1157808998987933},{"x":3281.049903869629,"y":1.0980765745716619},{"x":3324.39990234375,"y":1.0809253100666976},{"x":3367.749900817871,"y":1.0643015895555468},{"x":3411.099899291992,"y":1.0481814421439728},{"x":3454.4498977661133,"y":1.0325423275433463},{"x":3497.7998962402344,"y":1.017363030914728},{"x":3541.1498947143555,"y":1.0026235668538905},{"x":3584.4998931884766,"y":0.988305091603483},{"x":3627.8498916625977,"y":0.9743898226814759},{"x":3671.1998901367188,"y":0.9608609652050921},{"x":3714.54988861084,"y":0.94770264426839},{"x":3757.899887084961,"y":0.9348998428010384},{"x":3801.249885559082,"y":0.922438344396861},{"x":3844.599884033203,"y":0.9103046806545448},{"x":3887.949882507324,"y":0.8984860826204448},{"x":3931.2998809814453,"y":0.8869704359654493},{"x":3974.6498794555664,"y":0.8757462395651437},{"x":4017.9998779296875,"y":0.8648025671855634},{"x":4061.3498764038086,"y":0.8541290320062338},{"x":4104.69987487793,"y":0.8437157537383531},{"x":4148.049873352051,"y":0.8335533281193147},{"x":4191.399871826172,"y":0.8236327985855944},{"x":4234.749870300293,"y":0.8139456299446544},{"x":4278.099868774414,"y":0.8044836838832005},{"x":4321.449867248535,"y":0.7952391961640759},{"x":4364.799865722656,"y":0.7862047553775057},{"x":4408.149864196777,"y":0.7773732831244696},{"x":4451.499862670898,"y":0.7687380155208459},{"x":4494.8498611450195,"y":0.7602924859207518},{"x":4538.199859619141,"y":0.7520305087663414},{"x":4581.549858093262,"y":0.7439461644792932},{"x":4624.899856567383,"y":0.7360337853164337},{"x":4668.249855041504,"y":0.7282879421184743},{"x":4711.599853515625,"y":0.7207034318867515},{"x":4754.949851989746,"y":0.7132752661282358},{"x":4798.299850463867,"y":0.705998659913941},{"x":4841.649848937988,"y":0.6988690216003076},{"x":4884.999847412109,"y":0.6918819431671601}]}],"marks":[{"type":"line","from":{"data":"c2a92184-0dfe-4a33-ae87-8b0d70548078"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"interpolate":{"value":"step-before"},"fill":{"value":"steelblue"},"fillOpacity":{"value":0.4},"stroke":{"value":"steelblue"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}},{"type":"line","from":{"data":"27f7518d-f036-4900-8aa8-534d567323cd"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:bottom 20, :top 10, :right 10, :left 50}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"c2a92184-0dfe-4a33-ae87-8b0d70548078\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"c2a92184-0dfe-4a33-ae87-8b0d70548078\", :field \"data.y\"}}], :axes [{:scale \"x\", :type \"x\"} {:scale \"y\", :type \"y\"}], :data ({:name \"c2a92184-0dfe-4a33-ae87-8b0d70548078\", :values ({:x 550.0, :y 0} {:x 626.0526315789474, :y 41.0} {:x 702.1052631578948, :y 34.0} {:x 778.1578947368422, :y 15.0} {:x 854.2105263157896, :y 14.0} {:x 930.263157894737, :y 11.0} {:x 1006.3157894736844, :y 6.0} {:x 1082.3684210526317, :y 8.0} {:x 1158.421052631579, :y 3.0} {:x 1234.4736842105262, :y 6.0} {:x 1310.5263157894735, :y 6.0} {:x 1386.5789473684208, :y 4.0} {:x 1462.631578947368, :y 4.0} {:x 1538.6842105263154, :y 3.0} {:x 1614.7368421052627, :y 2.0} {:x 1690.78947368421, :y 3.0} {:x 1766.8421052631572, :y 3.0} {:x 1842.8947368421045, :y 0.0} {:x 1918.9473684210518, :y 4.0} {:x 1994.999999999999, :y 1.0} {:x 2071.0526315789466, :y 1.0} {:x 2147.105263157894, :y 0.0} {:x 2223.1578947368416, :y 1.0} {:x 2299.210526315789, :y 0.0} {:x 2375.2631578947367, :y 2.0} {:x 2451.315789473684, :y 1.0} {:x 2527.3684210526317, :y 0.0} {:x 2603.421052631579, :y 2.0} {:x 2679.4736842105267, :y 0.0} {:x 2755.526315789474, :y 3.0} {:x 2831.5789473684217, :y 0.0} {:x 2907.6315789473692, :y 0.0} {:x 2983.6842105263167, :y 0.0} {:x 3059.7368421052643, :y 1.0} {:x 3135.7894736842118, :y 1.0} {:x 3211.8421052631593, :y 0.0} {:x 3287.894736842107, :y 1.0} {:x 3363.9473684210543, :y 0.0} {:x 3440.000000000002, :y 0.0} {:x 3516.0526315789493, :y 0.0} {:x 3592.105263157897, :y 1.0} {:x 3668.1578947368444, :y 0.0} {:x 3744.210526315792, :y 0.0} {:x 3820.2631578947394, :y 0.0} {:x 3896.315789473687, :y 0.0} {:x 3972.3684210526344, :y 0.0} {:x 4048.421052631582, :y 0.0} {:x 4124.473684210529, :y 0.0} {:x 4200.526315789477, :y 0.0} {:x 4276.578947368424, :y 2.0} {:x 4352.631578947372, :y 0.0} {:x 4428.6842105263195, :y 0.0} {:x 4504.736842105267, :y 0.0} {:x 4580.7894736842145, :y 0.0} {:x 4656.842105263162, :y 0.0} {:x 4732.8947368421095, :y 0.0} {:x 4808.947368421057, :y 0.0} {:x 4885.000000000005, :y 1.0} {:x 4961.052631578952, :y 0})} {:name \"27f7518d-f036-4900-8aa8-534d567323cd\", :values ({:x 550, :y 3000N} {:x 593.3499984741211, :y 67.643745281086} {:x 636.6999969482422, :y 34.20752684598731} {:x 680.0499954223633, :y 22.892026743925083} {:x 723.3999938964844, :y 17.201835464401785} {:x 766.7499923706055, :y 13.777267991330485} {:x 810.0999908447266, :y 11.489851034824696} {:x 853.4499893188477, :y 9.85383512974319} {:x 896.7999877929688, :y 8.625647226260913} {:x 940.1499862670898, :y 7.66969220331636} {:x 983.4999847412109, :y 6.904488159618247} {:x 1026.849983215332, :y 6.278120969710528} {:x 1070.1999816894531, :y 5.755948014955019} {:x 1113.5499801635742, :y 5.3139670629884215} {:x 1156.8999786376953, :y 4.935022381022293} {:x 1200.2499771118164, :y 4.606526073604629} {:x 1243.5999755859375, :y 4.319032688518765} {:x 1286.9499740600586, :y 4.065316221226458} {:x 1330.2999725341797, :y 3.8397543907103593} {:x 1373.6499710083008, :y 3.637907118740204} {:x 1416.9999694824219, :y 3.45622131967224} {:x 1460.349967956543, :y 3.291819943469897} {:x 1503.699966430664, :y 3.1423484921824154} {:x 1547.0499649047852, :y 3.0058615354855536} {:x 1590.3999633789062, :y 2.880737570093874} {:x 1633.7499618530273, :y 2.7656142940768036} {:x 1677.0999603271484, :y 2.659338804630399} {:x 1720.4499588012695, :y 2.5609288535635475} {:x 1763.7999572753906, :y 2.4695423983455997} {:x 1807.1499557495117, :y 2.3844534479300794} {:x 1850.4999542236328, :y 2.3050327357019014} {:x 1893.849952697754, :y 2.23073213036297} {:x 1937.199951171875, :y 2.1610719676711514} {:x 1980.549949645996, :y 2.0956306838904655} {:x 2023.8999481201172, :y 2.0340362773920697} {:x 2067.2499465942383, :y 1.9759592330167022} {:x 2110.5999450683594, :y 1.921106624954879} {:x 2153.9499435424805, :y 1.869217175320954} {:x 2197.2999420166016, :y 1.8200570924789756} {:x 2240.6499404907227, :y 1.7734165492476204} {:x 2283.9999389648438, :y 1.7291066890699116} {:x 2327.349937438965, :y 1.6869570700580765} {:x 2370.699935913086, :y 1.6468134739744158} {:x 2414.049934387207, :y 1.6085360207718513} {:x 2457.399932861328, :y 1.5719975401078532} {:x 2500.749931335449, :y 1.5370821598785993} {:x 2544.0999298095703, :y 1.5036840787650902} {:x 2587.4499282836914, :y 1.4717064953986396} {:x 2630.7999267578125, :y 1.441060671316378} {:x 2674.1499252319336, :y 1.4116651086029082} {:x 2717.4999237060547, :y 1.3834448261694552} {:x 2760.849922180176, :y 1.3563307211381506} {:x 2804.199920654297, :y 1.330259003880071} {:x 2847.549919128418, :y 1.305170696983411} {:x 2890.899917602539, :y 1.2810111898680856} {:x 2934.24991607666, :y 1.257729841967462} {:x 2977.5999145507812, :y 1.2352796284088279} {:x 3020.9499130249023, :y 1.2136168229755624} {:x 3064.2999114990234, :y 1.192700713853289} {:x 3107.6499099731445, :y 1.1724933482718969} {:x 3150.9999084472656, :y 1.1529593026735498} {:x 3194.3499069213867, :y 1.1340654754785726} {:x 3237.699905395508, :y 1.1157808998987933} {:x 3281.049903869629, :y 1.0980765745716619} {:x 3324.39990234375, :y 1.0809253100666976} {:x 3367.749900817871, :y 1.0643015895555468} {:x 3411.099899291992, :y 1.0481814421439728} {:x 3454.4498977661133, :y 1.0325423275433463} {:x 3497.7998962402344, :y 1.017363030914728} {:x 3541.1498947143555, :y 1.0026235668538905} {:x 3584.4998931884766, :y 0.988305091603483} {:x 3627.8498916625977, :y 0.9743898226814759} {:x 3671.1998901367188, :y 0.9608609652050921} {:x 3714.54988861084, :y 0.94770264426839} {:x 3757.899887084961, :y 0.9348998428010384} {:x 3801.249885559082, :y 0.922438344396861} {:x 3844.599884033203, :y 0.9103046806545448} {:x 3887.949882507324, :y 0.8984860826204448} {:x 3931.2998809814453, :y 0.8869704359654493} {:x 3974.6498794555664, :y 0.8757462395651437} {:x 4017.9998779296875, :y 0.8648025671855634} {:x 4061.3498764038086, :y 0.8541290320062338} {:x 4104.69987487793, :y 0.8437157537383531} {:x 4148.049873352051, :y 0.8335533281193147} {:x 4191.399871826172, :y 0.8236327985855944} {:x 4234.749870300293, :y 0.8139456299446544} {:x 4278.099868774414, :y 0.8044836838832005} {:x 4321.449867248535, :y 0.7952391961640759} {:x 4364.799865722656, :y 0.7862047553775057} {:x 4408.149864196777, :y 0.7773732831244696} {:x 4451.499862670898, :y 0.7687380155208459} {:x 4494.8498611450195, :y 0.7602924859207518} {:x 4538.199859619141, :y 0.7520305087663414} {:x 4581.549858093262, :y 0.7439461644792932} {:x 4624.899856567383, :y 0.7360337853164337} {:x 4668.249855041504, :y 0.7282879421184743} {:x 4711.599853515625, :y 0.7207034318867515} {:x 4754.949851989746, :y 0.7132752661282358} {:x 4798.299850463867, :y 0.705998659913941} {:x 4841.649848937988, :y 0.6988690216003076} {:x 4884.999847412109, :y 0.6918819431671601})}), :marks ({:type \"line\", :from {:data \"c2a92184-0dfe-4a33-ae87-8b0d70548078\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :interpolate {:value \"step-before\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 0.4}, :stroke {:value \"steelblue\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}} {:type \"line\", :from {:data \"27f7518d-f036-4900-8aa8-534d567323cd\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}})}}"}
;; <=

;; @@

;; @@
